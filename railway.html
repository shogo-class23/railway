<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>鉄道総合案内システム</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #1abc9c;
            --danger: #e74c3c;
            --bg: #f4f7f6;
        }

        body { font-family: sans-serif; background-color: var(--bg); margin: 0; padding: 0; color: #333; }
        header { background: var(--primary); color: white; text-align: center; padding: 20px; }
        nav { background: #34495e; text-align: center; sticky: top; }
        nav button { background: none; border: none; color: white; padding: 15px 20px; cursor: pointer; font-size: 0.9rem; }
        nav button.active { background: var(--secondary); }

        .container { max-width: 800px; margin: 20px auto; padding: 0 15px; }
        .page { display: none; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .page.active { display: block; }

        h2 { border-bottom: 3px solid var(--secondary); padding-bottom: 5px; color: var(--primary); }

        /* フォーム */
        .search-form { background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .input-row { margin-bottom: 15px; }
        .input-row label { display: block; font-size: 0.8rem; font-weight: bold; margin-bottom: 5px; }
        input[type="text"], select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; }
        .type-options { margin: 15px 0; }
        .type-options label { margin-right: 15px; font-weight: bold; cursor: pointer; }

        .btn-search { background: var(--secondary); color: white; border: none; padding: 15px; width: 100%; border-radius: 6px; font-size: 1.1rem; font-weight: bold; cursor: pointer; }

        /* 前後の列車ボタン */
        .time-shift-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        .btn-shift {
            flex: 1;
            background: #ecf0f1;
            border: 1px solid #bdc3c7;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            color: #34495e;
        }
        .btn-shift:hover {
            background: #bdc3c7;
        }

        /* --- 検索結果 (デザイン統一版) --- */
        .route-box { border: 2px solid #eee; border-radius: 12px; padding: 25px; margin-top: 30px; background: #fff; }
        .route-time-header { border-bottom: 2px solid #f0f0f0; padding-bottom: 12px; margin-bottom: 20px; }
        .time-range-text { font-size: 1.5rem; font-weight: bold; color: var(--primary); display: block; }

        .vertical-station-list { padding-left: 35px; border-left: 3px solid #eee; margin-left: 15px; margin-top: 20px; }

        .station-item { display: block !important; width: 100% !important; clear: both !important; position: relative; margin-bottom: 30px !important; }
        .station-item::before { content: ''; position: absolute; left: -44px; top: 8px; width: 14px; height: 14px; background: white; border: 3px solid #ccc; border-radius: 50%; }

        .role-tag { display: block !important; font-size: 0.75rem; font-weight: bold; color: #888; margin-bottom: 4px; }
        .station-name-text { display: block !important; line-height: 1.2; font-size: 1.25rem; font-weight: bold; color: #333; }
        .time-info-text { display: block !important; font-size: 0.9rem; color: #7f8c8d; margin-top: 5px; }

        /* 乗る駅 */
        .boarding-station::before { border-color: var(--secondary); background: var(--secondary); }

        /* 経由駅 (統一感のある縮小) */
        .via-station { margin-top: 0; padding-bottom: 10px; }
        .via-station .station-name-text { font-size: 1.1rem !important; color: #7f8c8d !important; font-weight: bold !important; }
        .via-station::before { width: 10px; height: 10px; left: -42px; top: 10px; background: #eee; border: none; }

        /* 降りる駅 (少し大きく・赤) */
        .alighting-station .station-name-text { font-size: 1.6rem !important; color: var(--danger) !important; font-weight: 900 !important; }
        .alighting-station::before { width: 18px; height: 18px; left: -46px; top: 10px; background: var(--danger); border-color: var(--danger); }

        /* 路線図 */
        .route-map-svg { width: 100%; height: auto; border: 1px solid #ddd; background: #fff; border-radius: 8px; }

        /* 共通ページ要素 */
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #eee; padding: 12px; text-align: center; }
        th { background: var(--primary); color: white; }
    </style>
</head>
<body>

<header><h1>鉄道総合案内システム</h1></header>

<nav>
    <button onclick="showPage('status')" class="active">運行情報</button>
    <button onclick="showPage('timetable')">時刻表</button>
    <button onclick="showPage('routeMap')">路線図</button>
    <button onclick="showPage('transfer')">乗換案内</button>
</nav>

<div class="container">
    <section id="status" class="page active">
        <h2>運行情報</h2>
        <div style="padding:15px; border-left:8px solid var(--secondary); background:#f9f9f9; margin-bottom:10px;"><strong>本線</strong>: 平常運転</div>
    </section>

    <section id="timetable" class="page">
        <h2>時刻表</h2>
        <table><tr><th>列車</th><th>行先</th><th>時刻</th></tr><tr><td>急行</td><td>東駅</td><td>12:05</td></tr></table>
    </section>

    <section id="routeMap" class="page">
        <h2>路線図</h2>
        <svg class="route-map-svg" viewBox="0 0 600 300">
            <!-- 東西線 (Tozai Line) -->
            <line x1="50" y1="150" x2="550" y2="150" stroke="#2ecc71" stroke-width="10" />
            <circle cx="50" cy="150" r="6" fill="white" stroke="#2ecc71" stroke-width="2" />
            <text x="35" y="180" font-size="12">奥駅</text>
            
            <circle cx="175" cy="150" r="6" fill="white" stroke="#2ecc71" stroke-width="2" />
            <text x="160" y="180" font-size="12">西駅</text>
            
            <circle cx="300" cy="150" r="6" fill="white" stroke="#2ecc71" stroke-width="2" />
            <text x="285" y="180" font-size="12">本駅</text>
            
            <circle cx="425" cy="150" r="10" fill="white" stroke="#333" stroke-width="4" />
            <text x="405" y="185" font-size="14" font-weight="bold">中央駅</text>
            
            <circle cx="550" cy="150" r="6" fill="white" stroke="#2ecc71" stroke-width="2" />
            <text x="535" y="180" font-size="12">東駅</text>

            <!-- 南北線 (Nanboku Line) -->
            <line x1="425" y1="30" x2="425" y2="270" stroke="#3498db" stroke-width="8" />
            <circle cx="425" cy="30" r="6" fill="white" stroke="#3498db" stroke-width="2" />
            <text x="440" y="35" font-size="12">北駅</text>
            
            <circle cx="425" cy="90" r="6" fill="white" stroke="#3498db" stroke-width="2" />
            <text x="440" y="95" font-size="12">新駅</text>
            
            <!-- 中央駅は東西線と共通 -->
            
            <circle cx="425" cy="210" r="6" fill="white" stroke="#3498db" stroke-width="2" />
            <text x="440" y="215" font-size="12">市駅</text>
            
            <circle cx="425" cy="270" r="6" fill="white" stroke="#3498db" stroke-width="2" />
            <text x="440" y="275" font-size="12">南駅</text>
            
            <text x="20" y="145" font-size="10" fill="#2ecc71" font-weight="bold">東西線</text>
            <text x="415" y="20" font-size="10" fill="#3498db" font-weight="bold">南北線</text>
        </svg>
    </section>

    <section id="transfer" class="page">
        <h2>乗換案内</h2>
        <div class="search-form">
            <div class="input-row"><label>出発駅</label><input type="text" id="fromSt" placeholder="例: 東京"></div>
            <div class="input-row"><label>経由駅</label><input type="text" id="viaSt" placeholder="任意"></div>
            <div class="input-row"><label>降りる駅</label><input type="text" id="toSt" placeholder="例: 新宿"></div>
            <div class="input-row" style="display:flex; gap:10px;">
                <select id="hSel" style="width:70px;"></select>時
                <select id="mSel" style="width:70px;"></select>分
            </div>
            <div class="type-options">
                <label><input type="radio" name="stype" value="出発" checked>出発</label>
                <label><input type="radio" name="stype" value="到着">到着</label>
                <label><input type="radio" name="stype" value="始発">始発</label>
                <label><input type="radio" name="stype" value="終電">終電</label>
            </div>
            <button class="btn-search" onclick="search()">ルートを検索</button>
        </div>
        <div id="transferResults"></div>
    </section>
</div>

<script>
    const hs = document.getElementById('hSel');
    const ms = document.getElementById('mSel');
    for(let i=0; i<24; i++) hs.innerHTML += `<option value="${i}">${i.toString().padStart(2,'0')}</option>`;
    for(let i=0; i<60; i++) ms.innerHTML += `<option value="${i}">${i.toString().padStart(2,'0')}</option>`;
    hs.value = 12;

    function showPage(id) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
        const activeBtn = Array.from(document.querySelectorAll('nav button')).find(b => b.textContent.includes(document.querySelector(`#${id} h2`).textContent));
        if(activeBtn) activeBtn.classList.add('active');
    }

    function shiftTime(minutes) {
        const h = parseInt(hs.value);
        const m = parseInt(ms.value);
        let totalM = h * 60 + m + minutes;
        
        if (totalM < 0) totalM += 24 * 60;
        if (totalM >= 24 * 60) totalM -= 24 * 60;
        
        hs.value = Math.floor(totalM / 60);
        ms.value = totalM % 60;
        search();
    }

    function search() {
        const from = document.getElementById('fromSt').value;
        const via = document.getElementById('viaSt').value;
        const to = document.getElementById('toSt').value;
        const inputTime = `${hs.value.padStart(2,'0')}:${ms.value.padStart(2,'0')}`;
        const type = document.querySelector('input[name="stype"]:checked').value;

        if(!from || !to) return alert('駅名を入力してください');

        // 時刻の決定ロジック
        let startTime, endTime;
        
        if (type === "始発") {
            startTime = "04:30";
            endTime = "05:15";
        } else if (type === "終電") {
            startTime = "01:00";
            endTime = "01:45";
        } else if (type === "到着") {
            endTime = inputTime;
            const h = parseInt(hs.value);
            const m = parseInt(ms.value);
            let totalM = h * 60 + m - 45;
            if (totalM < 0) totalM += 24 * 60;
            startTime = `${Math.floor(totalM / 60).toString().padStart(2,'0')}:${(totalM % 60).toString().padStart(2,'0')}`;
        } else {
            startTime = inputTime;
            endTime = "12:45"; // ダミー
        }

        document.getElementById('transferResults').innerHTML = `
            <div class="route-box">
                <div class="route-time-header">
                    <span class="time-range-text">${startTime} 発 ～ ${endTime} 着</span>
                </div>
                <div class="route-info">
                    所要時間: 45分 / 運賃: 650円 / 条件: ${type}指定
                </div>
                <div class="vertical-station-list">
                    <div class="station-item boarding-station">
                        <span class="role-tag">【乗る場所】</span>
                        <span class="station-name-text">${from}</span>
                        <span class="time-info-text">${startTime} 発</span>
                    </div>
                    <div class="station-item via-station">
                        <span class="role-tag">【経由場所】</span>
                        <span class="station-name-text">${via || "中央駅"}</span>
                        <span class="time-info-text">乗換 5分</span>
                    </div>
                    <div class="station-item alighting-station">
                        <span class="role-tag">【降りる場所】</span>
                        <span class="station-name-text">${to}</span>
                        <span class="time-info-text">${endTime} 着</span>
                    </div>
                </div>
                <div class="time-shift-buttons">
                    <button class="btn-shift" onclick="shiftTime(-15)">1本前</button>
                    <button class="btn-shift" onclick="shiftTime(15)">1本後</button>
                </div>
            </div>
        `;
    }
</script>
</body>
</html>
